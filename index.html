<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>December 2025 Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: .5rem;
    }
    .day {
      min-height: 120px;
      background: #ffffff;
      border: 1px solid rgba(0,0,0,.1);
      border-radius: .75rem;
      padding: .5rem;
      position: relative;
      cursor: pointer;
      transition: background-color 0.2s, color 0.2s;
    }
    .day.selected {
      background-color: #28a745; /* green */
      color: #fff;
    }
    .day-number {
      font-weight: 700;
      font-size: .95rem;
      color: #0d6efd;
    }
    .day-content {
      margin-top: .35rem;
      font-size: .9rem;
      white-space: pre-wrap;
      max-height: 70px;
      overflow: auto;
    }
    .empty {
      background: #f8f9fa;
      border-style: dashed;
      cursor: default;
    }
    .weekday-header {
      font-weight: 600;
      text-align: center;
      text-transform: uppercase;
      font-size: .85rem;
      padding: .5rem 0;
      border-radius: .5rem;
      background-color: #f1f3f5;
      border: 1px solid rgba(0,0,0,.1);
    }
    body {
      background-image: url(christmas.jpg);
      background-size: cover;
      background-position: center;
    }
    h2 {
      font-weight: 600;
      text-align: center;
      text-transform: uppercase;
      font-size: 1.0rem;
      padding: 1.5rem;
      border-radius: 2.0rem;
      background-color: #ff0000;
      border: 1px solid rgba(0,0,0,.1);
      color: #f1f3f5;
    }
  </style>
</head>
<body class="bg-light">
  <div class="container py-4">
    <!-- Centered Heading -->
    <div class="d-flex justify-content-center mb-3">
      <h2 style="font-family: 'Comic Sans MS', cursive; font-style: italic; font-size: larger;">
        Buzz & Fizz's Christmas Movie Calendar 2025!
      </h2>
    </div>

    <!-- Export & Ideas Buttons -->
    <div class="d-flex justify-content-center gap-2 mb-3">
      <button id="exportBtn" class="btn btn-success btn-sm" type="button">Export PDF</button>
      <button id="ideasBtn" class="btn btn-warning btn-sm" type="button" data-bs-toggle="modal" data-bs-target="#ideasModal">
        ðŸ’¡ Send an idea!
      </button>
    </div>

    <!-- Weekday headers -->
    <div class="calendar mb-2">
      <div class="weekday-header">Mon</div>
      <div class="weekday-header">Tue</div>
      <div class="weekday-header">Wed</div>
      <div class="weekday-header">Thu</div>
      <div class="weekday-header">Fri</div>
      <div class="weekday-header">Sat</div>
      <div class="weekday-header">Sun</div>
    </div>

    <!-- Calendar grid -->
    <div id="calendar" class="calendar"></div>
  </div>

  <!-- Ideas Modal -->
  <div class="modal fade" id="ideasModal" tabindex="-1" aria-labelledby="ideasModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="ideasModalLabel">Send Us Your Idea!</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <textarea id="ideaText" class="form-control" rows="5" placeholder="Write your idea here..."></textarea>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button id="sendIdeaBtn" type="button" class="btn btn-primary">Submit</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Scripts -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    const YEAR = 2025;
    const MONTH_INDEX = 11; // December
    const DAYS_IN_MONTH = 31;
    const START_WEEKDAY = new Date(YEAR, MONTH_INDEX, 1).getDay() === 0 ? 6 : new Date(YEAR, MONTH_INDEX, 1).getDay() - 1;
    const calendarEl = document.getElementById('calendar');
    const exportBtn = document.getElementById('exportBtn');

    // Pre-fill entries
    const entries = {
      1: "Home Alone", 2: "Elf", 3: "The Santa Clause", 4: "Polar Express", 5: "It's a Wonderful Life",
      6: "How the Grinch Stole Christmas", 7: "Frosty the Snowman", 8: "A Christmas Carol", 9: "Arthur Christmas",
      10: "Jingle All the Way", 11: "The Holiday", 12: "Muppet Christmas Carol", 13: "Miracle on 34th Street",
      14: "Christmas with the Kranks", 15: "Love Actually", 16: "Klaus", 17: "Charlie Brown Christmas",
      18: "Scrooged", 19: "White Christmas", 20: "Jack Frost", 21: "Noelle", 22: "Deck the Halls",
      23: "The Christmas Chronicles", 24: "The Night Before", 25: "Violent Night",
      26: "National Lampoon's Christmas Vacation ðŸŽ…", 27: "Happiest Season", 28: "Christmas in Connecticut",
      29: "Holiday Inn", 30: "Four Christmases", 31: "New Year's Eve ðŸŽ‰"
    };

    function buildCalendar() {
      calendarEl.innerHTML = '';

      // Add empty boxes for starting weekday
      for (let i = 0; i < START_WEEKDAY; i++) {
        const empty = document.createElement('div');
        empty.className = 'day empty';
        calendarEl.appendChild(empty);
      }

      for (let day = 1; day <= DAYS_IN_MONTH; day++) {
        const cell = document.createElement('div');
        cell.className = 'day text-start';
        cell.innerHTML = `
          <div class="day-number">${day}</div>
          <div class="day-content">${entries[day] || ""}</div>
        `;

        // Restore green selection
        if (localStorage.getItem(`day-${day}-selected`) === 'true') {
          cell.classList.add('selected');
        }

        // Toggle green and save to localStorage
        cell.addEventListener('click', () => {
          cell.classList.toggle('selected');
          localStorage.setItem(`day-${day}-selected`, cell.classList.contains('selected'));
        });

        calendarEl.appendChild(cell);
      }
    }

    // Export PDF
    exportBtn.addEventListener('click', async () => {
      const { jsPDF } = window.jspdf;
      const canvas = await html2canvas(document.body, { scale: 2, backgroundColor: null, useCORS: true });
      const imgData = canvas.toDataURL('image/png');
      const pdf = new jsPDF({ orientation: "landscape", unit: "pt", format: "a4" });
      const pageWidth = pdf.internal.pageSize.getWidth();
      const imgWidth = pageWidth;
      const imgHeight = (canvas.height * pageWidth) / canvas.width;
      pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
      pdf.save("december-2025-calendar.pdf");
    });

    // Ideas button â†’ Outlook Web
    document.getElementById('sendIdeaBtn').addEventListener('click', function() {
      const idea = document.getElementById('ideaText').value.trim();
      if (!idea) { alert("Please write something before submitting!"); return; }
      const email = "paulpj1982@gmail.com";
      const subject = encodeURIComponent("New Calendar Idea");
      const body = encodeURIComponent(idea);
      const outlookUrl = `https://outlook.office.com/mail/deeplink/compose?to=${email}&subject=${subject}&body=${body}`;
      window.open(outlookUrl, "_blank");
    });

    buildCalendar();
  </script>
</body>
</html>
