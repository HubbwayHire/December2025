<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>December 2025 Calendar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap 5 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: .5rem;
    }
    .day {
      min-height: 120px;
      background: #ffffff;
      border: 1px solid rgba(0,0,0,.1);
      border-radius: .75rem;
      padding: .5rem .5rem 2.25rem .5rem;
      position: relative;
      cursor: pointer;
    }
    .day-number {
      font-weight: 700;
      font-size: .95rem;
      color: #0d6efd;
    }
    .day-content {
      margin-top: .35rem;
      font-size: .9rem;
      white-space: pre-wrap;
      max-height: 70px;
      overflow: auto;
    }
    .empty {
      background: #f8f9fa;
      border-style: dashed;
      cursor: default;
    }
    .edit-badge {
      position: absolute;
      right: .5rem;
      bottom: .5rem;
    }
    
    .weekday-header {
      font-weight: 600;
      text-align: center;
      text-transform: uppercase;
      font-size: .85rem;
      padding: .5rem 0;
      border-radius: .5rem;
      background-color: #f1f3f5; /* light gray */
      border: 1px solid rgba(0,0,0,.1);
    }
    body {
      background-image: url(christmas.jpg);
      background-size: cover;
    }
     h2 {
  font-weight: 600;
  text-align: center;
  text-transform: uppercase;
  font-size: 1.0rem;
  padding: 1.5rem; /* adds padding on all sides */
  border-radius: 2.0rem;
  background-color: #ff0000;
  border: 1px solid rgba(0,0,0,.1);
  color: #f1f3f5;
}

  </style>
</head>
<body class="bg-light">
  <div class="container py-4">
    <div class="d-flex align-items-center justify-content-between mb-3">
      <h2 style="font-family: 'Comic Sans MS', cursive; font-style: italic; font-size: larger;">
  Buzz & Fizz's Christmas Movie Calendar 2025!
</h2>
      <div class="d-flex gap-2">
  <button id="exportBtn" class="btn btn-success btn-sm" type="button">Export PDF</button>
  <button id="clearAllBtn" class="btn btn-danger btn-sm" type="button">Clear All Entries</button>
  <button id="saveFileBtn" class="btn btn-primary btn-sm" type="button">Save Calendar</button>
  <input type="file" id="loadFileInput" class="d-none" accept=".json">
  <button id="loadFileBtn" class="btn btn-secondary btn-sm" type="button">Load Calendar</button>
</div>


    </div>

    <!-- Weekday headers -->
    <div class="calendar mb-2">
      <div class="weekday-header">Mon</div>
      <div class="weekday-header">Tue</div>
      <div class="weekday-header">Wed</div>
      <div class="weekday-header">Thu</div>
      <div class="weekday-header">Fri</div>
      <div class="weekday-header">Sat</div>
      <div class="weekday-header">Sun</div>
    </div>

    <!-- Calendar grid -->
    <div id="calendar" class="calendar"></div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="entryModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered">
      <form id="entryForm" class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title">Edit Entry</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <div id="modalDay" class="mb-2 text-muted small"></div>
          <textarea id="entryText" class="form-control" rows="6" placeholder="Write your entryâ€¦"></textarea>
        </div>
        <div class="modal-footer">
          <button type="button" id="deleteEntryBtn" class="btn btn-outline-danger">Delete</button>
          <button type="submit" class="btn btn-primary">Save Entry</button>
        </div>
      </form>
    </div>
    
  </div>

  <!-- Bootstrap JS + Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <!-- jsPDF and html2canvas -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>

  <script>
    const YEAR = 2025;
    const MONTH_INDEX = 11; // Dec
    const DAYS_IN_MONTH = 31;
    const START_WEEKDAY = new Date(YEAR, MONTH_INDEX, 1).getDay() === 0 ? 6 : new Date(YEAR, MONTH_INDEX, 1).getDay() - 1;
    const STORAGE_KEY_PREFIX = 'dec2025-day-';

    const calendarEl = document.getElementById('calendar');
    const modalEl = document.getElementById('entryModal');
    const entryModal = new bootstrap.Modal(modalEl);
    const entryText = document.getElementById('entryText');
    const modalDay = document.getElementById('modalDay');
    const entryForm = document.getElementById('entryForm');
    const deleteEntryBtn = document.getElementById('deleteEntryBtn');
    const clearAllBtn = document.getElementById('clearAllBtn');
    const exportBtn = document.getElementById('exportBtn');

    let activeDay = null;

    function buildCalendar() {
      calendarEl.innerHTML = '';
      for (let i = 0; i < START_WEEKDAY; i++) {
        const empty = document.createElement('div');
        empty.className = 'day empty';
        calendarEl.appendChild(empty);
      }
      for (let day = 1; day <= DAYS_IN_MONTH; day++) {
        const cell = document.createElement('button');
        cell.type = 'button';
        cell.className = 'day text-start';
        cell.dataset.day = day;
        cell.innerHTML = `
          <div class="day-number">${day}</div>
          <div class="day-content" id="content-${day}">${loadEntry(day)}</div>
          <span class="badge text-bg-secondary edit-badge">Edit</span>
        `;
        cell.addEventListener('click', () => openEditor(day));
        calendarEl.appendChild(cell);
      }
    }

    function openEditor(day) {
      activeDay = day;
      modalDay.textContent = `December ${day}, ${YEAR}`;
      entryText.value = loadEntry(day) || '';
      deleteEntryBtn.classList.toggle('d-none', !entryText.value);
      entryModal.show();
    }

    entryForm.addEventListener('submit', (e) => {
      e.preventDefault();
      if (activeDay == null) return;
      saveEntry(activeDay, entryText.value.trim());
      renderDay(activeDay);
      entryModal.hide();
    });

    deleteEntryBtn.addEventListener('click', () => {
      if (activeDay == null) return;
      saveEntry(activeDay, '');
      renderDay(activeDay);
      entryModal.hide();
    });

    function loadEntry(day) {
      return localStorage.getItem(STORAGE_KEY_PREFIX + day) || '';
    }

    function saveEntry(day, text) {
      const key = STORAGE_KEY_PREFIX + day;
      if (text) localStorage.setItem(key, text);
      else localStorage.removeItem(key);
    }

    function renderDay(day) {
      document.getElementById(`content-${day}`).textContent = loadEntry(day);
    }

    clearAllBtn.addEventListener('click', () => {
      if (!confirm('Clear all entries?')) return;
      for (let d = 1; d <= DAYS_IN_MONTH; d++) {
        localStorage.removeItem(STORAGE_KEY_PREFIX + d);
        renderDay(d);
      }
    });

    exportBtn.addEventListener('click', async () => {
      const { jsPDF } = window.jspdf;
      document.querySelectorAll('.edit-badge').forEach(el => el.style.display = 'none');
      const container = document.querySelector('.container');
      const canvas = await html2canvas(container, { scale: 2 });
      const imgData = canvas.toDataURL('image/png');
      document.querySelectorAll('.edit-badge').forEach(el => el.style.display = '');
      const pdf = new jsPDF({ orientation: "landscape", unit: "pt", format: "a4" });
      const pageWidth = pdf.internal.pageSize.getWidth();
      const imgWidth = pageWidth;
      const imgHeight = (canvas.height * pageWidth) / canvas.width;
      pdf.addImage(imgData, 'PNG', 0, 0, imgWidth, imgHeight);
      pdf.save("december-2025-calendar.pdf");
    });

    buildCalendar();

    const saveFileBtn = document.getElementById('saveFileBtn');
const loadFileBtn = document.getElementById('loadFileBtn');
const loadFileInput = document.getElementById('loadFileInput');

// Save all entries as JSON file
saveFileBtn.addEventListener('click', () => {
  const data = {};
  for (let d = 1; d <= DAYS_IN_MONTH; d++) {
    const entry = loadEntry(d);
    if (entry) data[d] = entry;
  }
  const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = "december-2025-calendar.json";
  a.click();
  URL.revokeObjectURL(url);
});

// Trigger hidden file input
loadFileBtn.addEventListener('click', () => loadFileInput.click());

// Load JSON file and restore entries
loadFileInput.addEventListener('change', (e) => {
  const file = e.target.files[0];
  if (!file) return;
  const reader = new FileReader();
  reader.onload = function(event) {
    try {
      const data = JSON.parse(event.target.result);
      for (let d = 1; d <= DAYS_IN_MONTH; d++) {
        saveEntry(d, data[d] || '');
        renderDay(d);
      }
      alert("Calendar loaded successfully!");
    } catch (err) {
      alert("Invalid JSON file.");
    }
  };
  reader.readAsText(file);
});

  </script>
</body>
</html>
